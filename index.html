<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tra cá»©u thÃ´ng tin má»i ngÆ°á»i</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header>
    <h1>ğŸ§‘â€ğŸ¤â€ğŸ§‘ Tra Cá»©u ThÃ´ng Tin Má»i NgÆ°á»i</h1>
    <p class="subtitle">Má»™t nÆ¡i Ä‘á»ƒ má»i ngÆ°á»i chia sáº» thÃ´ng tin cÃ¡ nhÃ¢n cÃ´ng khai</p>
    <div class="top-actions">
      <input type="text" id="searchInput" placeholder="ğŸ” TÃ¬m theo tÃªn, tÃ¬nh tráº¡ng, trÆ°á»ng há»c...">
      <a href="add.html" class="btnPrimary">+ ÄÄƒng thÃ´ng tin</a>
    </div>
  </header>

  <!-- Danh sÃ¡ch ngÆ°á»i -->
  <main>
    <div id="peopleList" class="card-grid"></div>
  </main>

  <!-- Footer -->
  <footer>
    <p>Â© 2025 - Website tra cá»©u thÃ´ng tin cá»™ng Ä‘á»“ng | Made with â¤ï¸</p>
  </footer>

  <!-- Firebase & Script -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="config.js"></script>
  <script>
    const searchInput = document.getElementById('searchInput');
    const peopleList = document.getElementById('peopleList');
    let allPeople = [];

    // Táº£i danh sÃ¡ch
    firebase.database().ref('people').on('value', snapshot => {
      allPeople = [];
      peopleList.innerHTML = "";
      snapshot.forEach(child => {
        const id = child.key;
        const data = child.val();
        allPeople.push({id, ...data});
      });
      renderPeople(allPeople);
    });

    // HÃ m hiá»ƒn thá»‹
    function renderPeople(list){
      peopleList.innerHTML = "";
      if(list.length === 0){
        peopleList.innerHTML = "<p class='empty'>ğŸ˜• KhÃ´ng cÃ³ ai trong danh sÃ¡ch</p>";
        return;
      }
      list.forEach(person => {
        const card = document.createElement('div');
        card.className = "person-card";
        card.innerHTML = `
          <img src="${person.avatar || 'https://placehold.co/150x150?text=No+Avatar'}" alt="avatar">
          <div class="info">
            <h3>${person.name || 'ChÆ°a rÃµ tÃªn'}</h3>
            <p>ğŸ’¬ ${person.relationship || 'ChÆ°a rÃµ tÃ¬nh tráº¡ng'}</p>
            <p>ğŸ« ${person.school || person.level || 'ChÆ°a rÃµ nÆ¡i há»c/lÃ m'}</p>
            <a href="person.html?id=${person.id}" class="btnDetail">Xem chi tiáº¿t</a>
          </div>
        `;
        peopleList.appendChild(card);
      });
    }

    // TÃ¬m kiáº¿m
    searchInput.addEventListener('input', () => {
      const keyword = searchInput.value.toLowerCase().trim();
      const filtered = allPeople.filter(p => 
        (p.name && p.name.toLowerCase().includes(keyword)) ||
        (p.relationship && p.relationship.toLowerCase().includes(keyword)) ||
        (p.school && p.school.toLowerCase().includes(keyword)) ||
        (p.level && p.level.toLowerCase().includes(keyword))
      );
      renderPeople(filtered);
    });
  </script>
</body>
</html>
