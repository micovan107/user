<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tra c·ª©u th√¥ng tin m·ªçi ng∆∞·ªùi</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  
  <header>
    <h1> Tra C·ª©u Th√¥ng Tin M·ªçi Ng∆∞·ªùi</h1>
    <p class="subtitle">M·ªôt n∆°i ƒë·ªÉ m·ªçi ng∆∞·ªùi chia s·∫ª th√¥ng tin c√° nh√¢n c√¥ng khai</p>
    <div class="top-actions">
      <input type="text" id="searchInput" placeholder="üîç T√¨m theo t√™n, t√¨nh tr·∫°ng, tr∆∞·ªùng h·ªçc...">
      <a href="add.html" class="btnPrimary">+ ƒêƒÉng th√¥ng tin</a>
    </div>
  </header>

  <!-- Danh s√°ch ng∆∞·ªùi -->
  <main>
    <div id="peopleList" class="card-grid"></div>
  </main>

  <!-- Footer -->
  <footer>
    <p>¬© 2025 - Website tra c·ª©u th√¥ng tin c·ªông ƒë·ªìng</p>
  </footer>

  <!-- Firebase & Script -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="config.js"></script>
  <script>
    const searchInput = document.getElementById('searchInput');
    const peopleList = document.getElementById('peopleList');
    let allPeople = [];

    // T·∫£i danh s√°ch
    firebase.database().ref('people').on('value', snapshot => {
      allPeople = [];
      peopleList.innerHTML = "";
      snapshot.forEach(child => {
        const id = child.key;
        const data = child.val();
        allPeople.push({id, ...data});
      });
      renderPeople(allPeople);
    });

    // H√†m hi·ªÉn th·ªã
    function renderPeople(list){
      peopleList.innerHTML = "";
      if(list.length === 0){
        peopleList.innerHTML = "<p class='empty'>üòï Kh√¥ng c√≥ ai trong danh s√°ch</p>";
        return;
      }
      list.forEach(person => {
        const card = document.createElement('div');
        card.className = "person-card";
        card.innerHTML = `
          <img src="${person.avatar || 'https://placehold.co/150x150?text=No+Avatar'}" alt="avatar">
          <div class="info">
            <h3>${person.name || 'Ch∆∞a r√µ t√™n'}</h3>
            <p>üí¨ ${person.relationship || 'Ch∆∞a r√µ t√¨nh tr·∫°ng'}</p>
            <p>üè´ ${person.school || person.level || 'Ch∆∞a r√µ n∆°i h·ªçc/l√†m'}</p>
            <a href="person.html?id=${person.id}" class="btnDetail">Xem chi ti·∫øt</a>
          </div>
        `;
        peopleList.appendChild(card);
      });
    }

    // T√¨m ki·∫øm
    searchInput.addEventListener('input', () => {
      const keyword = searchInput.value.toLowerCase().trim();
      const filtered = allPeople.filter(p => 
        (p.name && p.name.toLowerCase().includes(keyword)) ||
        (p.relationship && p.relationship.toLowerCase().includes(keyword)) ||
        (p.school && p.school.toLowerCase().includes(keyword)) ||
        (p.level && p.level.toLowerCase().includes(keyword))
      );
      renderPeople(filtered);
    });
  </script>
</body>
</html>

