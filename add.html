<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>ƒêƒÉng th√¥ng tin ng∆∞·ªùi d√πng</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="form-container">
    <h1>üìù ƒêƒÉng th√¥ng tin c·ªßa b·∫°n</h1>
    <p class="desc">Th√¥ng tin b·∫°n nh·∫≠p s·∫Ω hi·ªÉn th·ªã c√¥ng khai tr√™n trang ch·ªß ƒë·ªÉ m·ªçi ng∆∞·ªùi c√≥ th·ªÉ tra c·ª©u.</p>

    <form id="addForm">
      <label for="name">H·ªç v√† t√™n *</label>
      <input type="text" id="name" placeholder="VD: Nguy·ªÖn VƒÉn A" required>

      <label for="dob">Ng√†y sinh</label>
      <input type="date" id="dob">

      <label for="relationship">T√¨nh tr·∫°ng t√¨nh c·∫£m</label>
      <select id="relationship">
        <option value="">-- Ch·ªçn --</option>
        <option>ƒê·ªôc th√¢n</option>
        <option>C√≥ ng∆∞·ªùi y√™u</option>
        <option>ƒê√£ k·∫øt h√¥n</option>
        <option>Kh√≥ n√≥i üò∂</option>
      </select>

      <label for="level">C·∫•p h·ªçc / ngh·ªÅ nghi·ªáp</label>
      <select id="level">
        <option value="">-- Ch·ªçn --</option>
        <option>Ti·ªÉu h·ªçc</option>
        <option>THCS</option>
        <option>THPT</option>
        <option>ƒê·∫°i h·ªçc</option>
        <option>Lao ƒë·ªông</option>
        <option>Kh√°c</option>
      </select>

      <label for="studyPower">H·ªçc l·ª±c (n·∫øu c√≤n ƒëi h·ªçc)</label>
      <select id="studyPower">
        <option value="">-- Ch·ªçn --</option>
        <option>Y·∫øu</option>
        <option>Trung b√¨nh</option>
        <option>Kh√°</option>
        <option>Gi·ªèi</option>
        <option>Xu·∫•t s·∫Øc</option>
      </select>

      <label for="school">Tr∆∞·ªùng h·ªçc / N∆°i l√†m vi·ªác</label>
      <input type="text" id="school" placeholder="VD: THPT Nguy·ªÖn Tr√£i">

      <label for="address">N∆°i ·ªü hi·ªán t·∫°i</label>
      <input type="text" id="address" placeholder="VD: H√† N·ªôi, Vi·ªát Nam">

      <label for="phone">S·ªë ƒëi·ªán tho·∫°i</label>
      <input type="text" id="phone" placeholder="VD: 0123 456 789">

      <label for="skills">NƒÉng l·ª±c h·ªçc / ngh·ªÅ nghi·ªáp</label>
      <input type="text" id="skills" placeholder="VD: Gi·ªèi To√°n, l·∫≠p tr√¨nh, ...">

      <label for="fears">N·ªói s·ª£</label>
      <input type="text" id="fears" placeholder="VD: B√≥ng t·ªëi, ƒë·ªô cao, ...">

      <label for="interests">S·ªü th√≠ch</label>
      <input type="text" id="interests" placeholder="VD: Ch∆°i game, ƒë·ªçc s√°ch, ...">

      <label for="avatar">·∫¢nh ƒë·∫°i di·ªán</label>
      <input type="file" id="avatar">

      <button type="submit" class="btnPrimary">ƒêƒÉng th√¥ng tin ‚úÖ</button>
    </form>

    <p style="text-align:center;margin-top:20px;">
      <a href="index.html" class="btnBack">‚¨Ö Quay l·∫°i trang ch·ªß</a>
    </p>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
  <script src="config.js"></script>
  <script>
    const form = document.getElementById('addForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      let avatarUrl = "";
      const file = document.getElementById('avatar').files[0];
      if(file){
        const formData = new FormData();
        formData.append("file", file);
        formData.append("upload_preset", uploadPreset);
        const res = await axios.post(`https://api.cloudinary.com/v1_1/${cloudName}/image/upload`, formData);
        avatarUrl = res.data.secure_url;
      }

      const data = {
        name: document.getElementById('name').value,
        dob: document.getElementById('dob').value,
        relationship: document.getElementById('relationship').value,
        level: document.getElementById('level').value,
        studyPower: document.getElementById('studyPower').value,
        school: document.getElementById('school').value,
        address: document.getElementById('address').value,
        phone: document.getElementById('phone').value,
        skills: document.getElementById('skills').value,
        fears: document.getElementById('fears').value,
        interests: document.getElementById('interests').value,
        avatar: avatarUrl
      };

      const ref = firebase.database().ref('people').push();
      await ref.set(data);

      alert('‚úÖ Th√™m th√¥ng tin th√†nh c√¥ng!');
      window.location.href = "index.html";
    });
  </script>
</body>
</html>
